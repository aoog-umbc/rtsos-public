MODULE AEROSOL_MICROPHYSICAL_MODEL
INTEGER,PARAMETER :: NWV_SF=16
INTEGER,PARAMETER :: NAEROSOL=20,NRH=5,NFINEMODE=10

REAL*8 :: WV_REF=0.55d0  ! additional wavelength at which aerosol optical depth is assigned.

REAL*8,DIMENSION(NRH)::RH=(/0.50,0.70,0.80,0.90,0.95/)

REAL*8,DIMENSION(NWV_SF) :: WV_SF=(/0.30D0, 0.3371D0, 0.40D0, 0.4880D0, 0.5145D0, &
       0.55D0, 0.6322D0, 0.6943D0, 0.86D0, 1.06D0, 1.30D0, 1.5360D0, 1.80D0,     &
       2.D0, 2.25D0, 2.50D0/)

REAL*8,DIMENSION(NWV_SF) ::    MR_WATER_SOLUBLE_SF=(/1.53D0, 1.53D0, 1.53D0, 1.53D0, &
       1.53D0, 1.53D0, 1.53D0, 1.53D0, 1.52D0, 1.52D0,1.51D0, 1.51D0, 1.46D0, 1.42D0,&
       1.42D0, 1.42D0/)
REAL*8,DIMENSION(NWV_SF) ::    MI_WATER_SOLUBLE_SF=(/0.008D0, 0.005D0, 0.005D0,  &
       0.005D0, 0.005D0, 0.006D0, 0.006D0, 0.007D0,0.012D0, 0.017D0, 0.02D0,     &
       0.023D0, 0.017D0, 0.008D0, 0.01D0, 0.012D0/)
REAL*8,DIMENSION(NWV_SF) ::    MR_DUST_SF=(/1.53D0, 1.53D0, 1.53D0, 1.53D0,      &
       1.53D0, 1.53D0, 1.53D0, 1.53D0, 1.52D0, 1.52D0, 1.46D0, 1.40D0,1.33D0,    &
       1.26D0, 1.22D0, 1.18D0/)
REAL*8,DIMENSION(NWV_SF) ::    MI_DUST_SF=(/0.008D0, 0.008D0, 0.008D0, 0.008D0,  &
       0.008D0, 0.008D0, 0.008D0, 0.008D0, 0.008D0, 0.008D0,0.008D0, 0.008D0,    &
       0.008D0, 0.008D0, 0.009D0, 0.009D0/)
REAL*8,DIMENSION(NWV_SF) ::    MR_SOOT_SF=(/1.74D0, 1.75D0, 1.75D0, 1.75D0, 1.75D0, &
       1.75D0, 1.75D0, 1.75D0, 1.75D0, 1.75D0, 1.76D0, 1.77D0,1.79D0, 1.80D0, 1.81D0, 1.82D0/)
REAL*8,DIMENSION(NWV_SF) ::    MI_SOOT_SF=(/0.47D0, 0.47D0, 0.46D0, 0.45D0, 0.45D0, &
       0.44D0, 0.43D0, 0.43D0, 0.43D0, 0.44D0, 0.45D0, 0.46D0,0.48D0, 0.49D0, 0.50D0, 0.51D0/)
REAL*8,DIMENSION(NWV_SF) ::    MR_SALT_SF=(/1.51D0,1.51D0,1.50D0,1.50D0,1.50D0, &
       1.50D0,1.49D0,1.49D0,1.48D0,1.47D0,1.47D0,1.46D0,1.45D0,1.45D0,1.44D0,1.43D0/)
REAL*8,DIMENSION(NWV_SF) ::    MI_SALT_SF=(/2.0D-6,4.0D-7,3.0D-8,2.0D-8,1.0D-8,  &
       1.0D-8,2.0D-8,1.0D-7,3.0D-6,2.0D-4,4.0D-4,6.0D-4,8.0D-4,1.0D-3,2.0D-3,4.0D-3/)
REAL*8,DIMENSION(NWV_SF) ::    MR_WATER_SF=(/1.349D0,1.345D0,1.339D0,1.335D0,   &
       1.334D0,1.333D0,1.332D0,1.331D0,1.329D0,1.326D0,1.323D0,1.318D0,1.312D0,1.306D0,1.292D0,1.261D0/)
REAL*8,DIMENSION(NWV_SF) ::    MI_WATER_SF=(/1.6D-8,8.45D-9,1.86D-9,9.69D-10,   &
       1.18D-9,1.96D-9,1.46D-8,3.05D-8,3.29D-7,4.18D-6,3.69D-5,9.97D-5,1.15D-4,1.10D-3,3.9D-4,1.74D-3/)

REAL*8,DIMENSION(NRH) :: RTROPOSPHERE=(/0.02748,0.02846,0.03274,0.03884,0.04238/),  &
                         RRURALC=(/0.4377, 0.4571,0.5477,0.6462,0.7078/),            &
                         ROCEANIC=(/0.1711,0.2041,0.3180,0.3803,0.4606/),            &
                         RURBANF=(/0.02563,0.02911,0.03514,0.04187,0.04904/),        &
                         RURBANC=(/0.4113,0.4777,0.5805,0.7061,0.8634/),             &
                         RZIAF=(/0.152, 0.158, 0.187, 0.221, 0.246/),           &
                         RZIAC=(/2.477,2.927,3.966,4.638,5.549/),               &
                         RATIO_WETDRY_ZIAF=(/1.0190,1.0630,1.2550, 1.4860, 1.6480/), &
                         RATIO_WETDRY_ZIAC=(/1.0240,1.2100,1.6390, 1.9170, 2.2930/)
REAL*8,DIMENSION(NFINEMODE) :: RATIO_FINE_MODE_ZIA=(/0.0, 0.01, 0.02, 0.05, 0.1, 0.2,&
                                       0.3, 0.5, 0.8, 0.95/) ! from personal communication with Zia
REAL*8,PARAMETER :: SIGF_SF=0.35*LOG(10.0),SIGC_SF=0.4*LOG(10.0),&
                    SIGF_ZIA=0.437,SIGC_ZIA=0.672
REAL*8,DIMENSION(:,:),ALLOCATABLE :: MR_TRPOSPHERE,MI_TRPOSPHERE,MR_RURALC,MI_RURALC,&
                             MR_OCEANIC,MI_OCEANIC,MR_URBANF,MI_URBANF,MR_URBANC,MI_URBANC, &
                             MR_URBANAF,MI_URBANAF,MR_URBANAC,MI_URBANAC, &
                             MR_URBANA1F,MI_URBANA1F,MR_URBANA1C,MI_URBANA1C, &
                             MR_URBANA2F,MI_URBANA2F,MR_URBANA2C,MI_URBANA2C, &
                             MR_URBANA3F,MI_URBANA3F,MR_URBANA3C,MI_URBANA3C, &
                             MR_ZIAF,MI_ZIAF,MR_ZIAC,MI_ZIAC

CONTAINS
SUBROUTINE ARSL_INDX_DEALLO

DEALLOCATE(MR_TRPOSPHERE,MI_TRPOSPHERE,MR_RURALC,MI_RURALC,&
           MR_OCEANIC,MI_OCEANIC,MR_URBANF,MI_URBANF,MR_URBANC,MI_URBANC, &
           MR_URBANAF,MI_URBANAF,MR_URBANAC,MI_URBANAC, &
           MR_URBANA1F,MI_URBANA1F,MR_URBANA1C,MI_URBANA1C, &
           MR_URBANA2F,MI_URBANA2F,MR_URBANA2C,MI_URBANA2C, &
           MR_URBANA3F,MI_URBANA3F,MR_URBANA3C,MI_URBANA3C, &
           MR_ZIAF,MI_ZIAF,MR_ZIAC,MI_ZIAC)

END SUBROUTINE ARSL_INDX_DEALLO

SUBROUTINE ARSL_INDX_INIT(NWV, WV)
IMPLICIT NONE
INTEGER, INTENT(IN) :: NWV
REAL*8,DIMENSION(NWV),INTENT(IN)::WV

REAL*8,DIMENSION(NRH) ::RATIO_WETDRY_TROPO,RATIO_WETDRY_RURALC,RATIO_WETDRY_OCEANIC,&
                        RATIO_WETDRY_URBANF,RATIO_WETDRY_URBANC
REAL*8,DIMENSION(:),ALLOCATABLE::MR_WATER_SOLUBLE,MI_WATER_SOLUBLE,MR_DUST,MI_DUST,MR_SALT,MI_SALT,&
                      MR_SOOT,MI_SOOT,MR_WATER,MI_WATER
REAL*8,DIMENSION(:),ALLOCATABLE::MR_TROPO_RH0,MI_TROPO_RH0,MR_URBAN_RH0,MI_URBAN_RH0
REAL*8,DIMENSION(:,:),ALLOCATABLE::MR_SOOTF_TMP,MI_SOOTF_TMP,MR_DUSTF_TMP,MI_DUSTF_TMP
REAL*8 :: WV_tmp

REAL*8 :: POLINT_SIMPLE

INTEGER :: IWV,IRH

ALLOCATE(MR_TRPOSPHERE(NWV+1,NRH),MI_TRPOSPHERE(NWV+1,NRH),MR_RURALC(NWV+1,NRH),MI_RURALC(NWV+1,NRH),&
         MR_OCEANIC(NWV+1,NRH),MI_OCEANIC(NWV+1,NRH),MR_URBANF(NWV+1,NRH),MI_URBANF(NWV+1,NRH),      &
         MR_URBANC(NWV+1,NRH),MI_URBANC(NWV+1,NRH),MR_URBANAF(NWV+1,NRH),MI_URBANAF(NWV+1,NRH),      &
         MR_URBANAC(NWV+1,NRH),MI_URBANAC(NWV+1,NRH),MR_URBANA1F(NWV+1,NRH),MI_URBANA1F(NWV+1,NRH),  &
         MR_URBANA1C(NWV+1,NRH),MI_URBANA1C(NWV+1,NRH),MR_URBANA2F(NWV+1,NRH),MI_URBANA2F(NWV+1,NRH),&
         MR_URBANA2C(NWV+1,NRH),MI_URBANA2C(NWV+1,NRH),MR_URBANA3F(NWV+1,NRH),MI_URBANA3F(NWV+1,NRH),&
         MR_URBANA3C(NWV+1,NRH),MI_URBANA3C(NWV+1,NRH),MR_ZIAF(NWV+1,NRH),MI_ZIAF(NWV+1,NRH),        &
         MR_ZIAC(NWV+1,NRH),MI_ZIAC(NWV+1,NRH))


ALLOCATE(MR_WATER_SOLUBLE(NWV+1),MI_WATER_SOLUBLE(NWV+1),MR_DUST(NWV+1),MI_DUST(NWV+1),   &
  MR_SALT(NWV+1),MI_SALT(NWV+1),MR_SOOT(NWV+1),MI_SOOT(NWV+1),MR_WATER(NWV+1),MI_WATER(NWV+1),&
  MR_TROPO_RH0(NWV+1),MI_TROPO_RH0(NWV+1),MR_URBAN_RH0(NWV+1),MI_URBAN_RH0(NWV+1),        &
  MR_SOOTF_TMP(NWV+1,NRH),MI_SOOTF_TMP(NWV+1,NRH),MR_DUSTF_TMP(NWV+1,NRH),MI_DUSTF_TMP(NWV+1,NRH))

DO IWV=1,NWV+1
   IF(IWV==NWV+1)THEN
      WV_tmp=WV_REF;
   ELSE
      WV_tmp=WV(IWV);
   ENDIF
   MR_WATER_SOLUBLE(IWV)=POLINT_SIMPLE(NWV_SF,WV_SF,MR_WATER_SOLUBLE_SF,WV_tmp,3)
   MI_WATER_SOLUBLE(IWV)=POLINT_SIMPLE(NWV_SF,WV_SF,MI_WATER_SOLUBLE_SF,WV_tmp,3)

   MR_DUST(IWV)=POLINT_SIMPLE(NWV_SF,WV_SF,MR_DUST_SF,WV_tmp,3)
   MI_DUST(IWV)=POLINT_SIMPLE(NWV_SF,WV_SF,MI_DUST_SF,WV_tmp,3)

   MR_SALT(IWV)=POLINT_SIMPLE(NWV_SF,WV_SF,MR_SALT_SF,WV_tmp,3)
   MI_SALT(IWV)=POLINT_SIMPLE(NWV_SF,WV_SF,MI_SALT_SF,WV_tmp,3)

   MR_SOOT(IWV)=POLINT_SIMPLE(NWV_SF,WV_SF,MR_SOOT_SF,WV_tmp,3)
   MI_SOOT(IWV)=POLINT_SIMPLE(NWV_SF,WV_SF,MI_SOOT_SF,WV_tmp,3)

   MR_WATER(IWV)=POLINT_SIMPLE(NWV_SF,WV_SF,MR_WATER_SF,WV_tmp,3)
   MI_WATER(IWV)=POLINT_SIMPLE(NWV_SF,WV_SF,MI_WATER_SF,WV_tmp,3)
ENDDO

RATIO_WETDRY_TROPO=RTROPOSPHERE/0.027d0
RATIO_WETDRY_RURALC=RRURALC/0.43d0
RATIO_WETDRY_OCEANIC=ROCEANIC/0.16d0
RATIO_WETDRY_URBANF=RURBANF/0.025d0
RATIO_WETDRY_URBANC=RURBANC/0.4d0

MR_TROPO_RH0=0.7*MR_WATER_SOLUBLE+0.3*MR_DUST
MI_TROPO_RH0=0.7*MI_WATER_SOLUBLE+0.3*MI_DUST
   DO IWV=1,NWV+1
   DO IRH=1,NRH
    MR_TRPOSPHERE(IWV,IRH)=MR_WATER(IWV)+(MR_TROPO_RH0(IWV)-MR_WATER(IWV))&
               /RATIO_WETDRY_TROPO(IRH)**3
   ENDDO
   ENDDO
   DO IWV=1,NWV+1
   DO IRH=1,NRH
    MI_TRPOSPHERE(IWV,IRH)=MI_WATER(IWV)+(MI_TROPO_RH0(IWV)-MI_WATER(IWV))&
               /RATIO_WETDRY_TROPO(IRH)**3
   ENDDO
   ENDDO

   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_RURALC(IWV,IRH)=MR_WATER(IWV)+(MR_TROPO_RH0(IWV)-MR_WATER(IWV))&
               /RATIO_WETDRY_RURALC(IRH)**3
   ENDDO 
   ENDDO
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MI_RURALC(IWV,IRH)=MI_WATER(IWV)+(MI_TROPO_RH0(IWV)-MI_WATER(IWV))&
               /RATIO_WETDRY_RURALC(IRH)**3
   ENDDO 
   ENDDO
   
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_OCEANIC(IWV,IRH)=MR_WATER(IWV)+(MR_SALT(IWV)-MR_WATER(IWV))&
               /RATIO_WETDRY_OCEANIC(IRH)**3
   ENDDO 
   ENDDO
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MI_OCEANIC(IWV,IRH)=MI_WATER(IWV)+(MI_SALT(IWV)-MI_WATER(IWV))&
               /RATIO_WETDRY_OCEANIC(IRH)**3
   ENDDO 
   ENDDO

   MR_URBAN_RH0=0.8*MR_TROPO_RH0+0.2*MR_SOOT
   MI_URBAN_RH0=0.8*MI_TROPO_RH0+0.2*MI_SOOT

   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_URBANF(IWV,IRH)=MR_WATER(IWV)+(MR_URBAN_RH0(IWV)-MR_WATER(IWV))&
               /RATIO_WETDRY_URBANF(IRH)**3
!        write(*,*)WV(IWV),RH(IRH),MR_URBANF(IWV,IRH)
   ENDDO 
   ENDDO
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MI_URBANF(IWV,IRH)=MI_WATER(IWV)+(MI_URBAN_RH0(IWV)-MI_WATER(IWV))&
               /RATIO_WETDRY_URBANF(IRH)**3
!       write(*,*)WV(IWV),RH(IRH),MI_URBANF(IWV,IRH),MI_WATER(IWV)
   ENDDO 
   ENDDO
   
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_URBANC(IWV,IRH)=MR_WATER(IWV)+(MR_URBAN_RH0(IWV)-MR_WATER(IWV))&
               /RATIO_WETDRY_URBANC(IRH)**3
   ENDDO
   ENDDO
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MI_URBANC(IWV,IRH)=MI_WATER(IWV)+(MI_URBAN_RH0(IWV)-MI_WATER(IWV))&
               /RATIO_WETDRY_URBANC(IRH)**3
   ENDDO 
   ENDDO

   ! URBAN A !
   MR_URBAN_RH0=0.85*MR_TROPO_RH0 +0.15*MR_SOOT
   MI_URBAN_RH0=0.85*MI_TROPO_RH0+0.15*MI_SOOT

   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_URBANAF(IWV,IRH)=MR_WATER(IWV)+(MR_URBAN_RH0(IWV)-MR_WATER(IWV))&
               /RATIO_WETDRY_URBANF(IRH)**3
   ENDDO 
   ENDDO
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MI_URBANAF(IWV,IRH)=MI_WATER(IWV)+(MI_URBAN_RH0(IWV)-MI_WATER(IWV))&
               /RATIO_WETDRY_URBANF(IRH)**3
   ENDDO 
   ENDDO
   
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_URBANAC(IWV,IRH)=MR_WATER(IWV)+(MR_URBAN_RH0(IWV)-MR_WATER(IWV))&
               /RATIO_WETDRY_URBANC(IRH)**3
   ENDDO 
   ENDDO
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MI_URBANAC(IWV,IRH)=MI_WATER(IWV)+(MI_URBAN_RH0(IWV)-MI_WATER(IWV))&
               /RATIO_WETDRY_URBANC(IRH)**3
   ENDDO 
   ENDDO
   
   ! URBAN A1 !
   MR_URBAN_RH0=0.90*MR_TROPO_RH0+0.10*MR_SOOT
   MI_URBAN_RH0=0.90*MI_TROPO_RH0+0.10*MI_SOOT


   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_URBANA1F(IWV,IRH)=MR_WATER(IWV)+(MR_URBAN_RH0(IWV)-MR_WATER(IWV))&
               /RATIO_WETDRY_URBANF(IRH)**3
   ENDDO 
   ENDDO
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MI_URBANA1F(IWV,IRH)=MI_WATER(IWV)+(MI_URBAN_RH0(IWV)-MI_WATER(IWV))&
               /RATIO_WETDRY_URBANF(IRH)**3
   ENDDO 
   ENDDO
   
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_URBANA1C(IWV,IRH)=MR_WATER(IWV)+(MR_URBAN_RH0(IWV)-MR_WATER(IWV))&
               /RATIO_WETDRY_URBANC(IRH)**3
   ENDDO 
   ENDDO
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MI_URBANA1C(IWV,IRH)=MI_WATER(IWV)+(MI_URBAN_RH0(IWV)-MI_WATER(IWV))&
               /RATIO_WETDRY_URBANC(IRH)**3
   ENDDO 
   ENDDO

   
   ! URBAN A2 !
   MR_URBAN_RH0=0.95*MR_TROPO_RH0+0.05*MR_SOOT
   MI_URBAN_RH0=0.95*MI_TROPO_RH0+0.05*MI_SOOT

   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_URBANA2F(IWV,IRH)=MR_WATER(IWV)+(MR_URBAN_RH0(IWV)-MR_WATER(IWV))&
               /RATIO_WETDRY_URBANF(IRH)**3
   ENDDO 
   ENDDO
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MI_URBANA2F(IWV,IRH)=MI_WATER(IWV)+(MI_URBAN_RH0(IWV)-MI_WATER(IWV))&
               /RATIO_WETDRY_URBANF(IRH)**3
   ENDDO 
   ENDDO
   
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_URBANA2C(IWV,IRH)=MR_WATER(IWV)+(MR_URBAN_RH0(IWV)-MR_WATER(IWV))&
               /RATIO_WETDRY_URBANC(IRH)**3
   ENDDO 
   ENDDO
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MI_URBANA2C(IWV,IRH)=MI_WATER(IWV)+(MI_URBAN_RH0(IWV)-MI_WATER(IWV))&
               /RATIO_WETDRY_URBANC(IRH)**3
   ENDDO 
   ENDDO
   
      ! URBAN A3 !
   MR_URBAN_RH0=0.975*MR_TROPO_RH0+0.025*MR_SOOT
   MI_URBAN_RH0=0.975*MI_TROPO_RH0+0.025*MI_SOOT

   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_URBANA3F(IWV,IRH)=MR_WATER(IWV)+(MR_URBAN_RH0(IWV)-MR_WATER(IWV))&
               /RATIO_WETDRY_URBANF(IRH)**3
   ENDDO 
   ENDDO
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MI_URBANA3F(IWV,IRH)=MI_WATER(IWV)+(MI_URBAN_RH0(IWV)-MI_WATER(IWV))&
               /RATIO_WETDRY_URBANF(IRH)**3
   ENDDO 
   ENDDO

   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_URBANA3C(IWV,IRH)=MR_WATER(IWV)+(MR_URBAN_RH0(IWV)-MR_WATER(IWV))&
               /RATIO_WETDRY_URBANC(IRH)**3
   ENDDO 
   ENDDO
   DO IWV=1,NWV+1
   DO IRH=1,NRH
    MI_URBANA3C(IWV,IRH)=MI_WATER(IWV)+(MI_URBAN_RH0(IWV)-MI_WATER(IWV))&
               /RATIO_WETDRY_URBANC(IRH)**3
   ENDDO 
   ENDDO
   
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_ZIAC(IWV,IRH)=MR_WATER(IWV)+(MR_SALT(IWV)-MR_WATER(IWV)) &
               /RATIO_WETDRY_ZIAC(IRH)**3
   ENDDO 
   ENDDO

   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MI_ZIAC(IWV,IRH)=MI_WATER(IWV)+(MI_SALT(IWV)-MI_WATER(IWV)) &
               /RATIO_WETDRY_ZIAC(IRH)**3
   ENDDO 
   ENDDO
   
   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MR_SOOTF_TMP(IWV,IRH)=MR_WATER(IWV)+(MR_SOOT(IWV)-MR_WATER(IWV)) &
               /RATIO_WETDRY_ZIAF(IRH)**3
    MR_DUSTF_TMP(IWV,IRH)=MR_WATER(IWV)+(MR_DUST(IWV)-MR_WATER(IWV)) &
               /RATIO_WETDRY_ZIAF(IRH)**3
   ENDDO 
   ENDDO
   
   MR_ZIAF=0.995*MR_DUSTF_TMP+0.005*MR_SOOTF_TMP

   DO IWV=1,NWV+1 
   DO IRH=1,NRH
    MI_SOOTF_TMP(IWV,IRH)=MI_WATER(IWV)+(MI_SOOT(IWV)-MI_WATER(IWV)) &
               /RATIO_WETDRY_ZIAF(IRH)**3
    MI_DUSTF_TMP(IWV,IRH)=MI_WATER(IWV)+(MI_DUST(IWV)-MI_WATER(IWV)) &
               /RATIO_WETDRY_ZIAF(IRH)**3
   ENDDO 
   ENDDO
   
   MI_ZIAF=0.995*MI_DUSTF_TMP+0.005*MI_SOOTF_TMP

DEALLOCATE(MR_WATER_SOLUBLE,MI_WATER_SOLUBLE,MR_DUST,MI_DUST,MR_SALT,MI_SALT,&
           MR_SOOT,MI_SOOT,MR_WATER,MI_WATER,MR_TROPO_RH0,MI_TROPO_RH0,      &
           MR_URBAN_RH0,MI_URBAN_RH0,MR_SOOTF_TMP,MI_SOOTF_TMP,MR_DUSTF_TMP, &
           MI_DUSTF_TMP)


END SUBROUTINE ARSL_INDX_INIT

END MODULE AEROSOL_MICROPHYSICAL_MODEL
