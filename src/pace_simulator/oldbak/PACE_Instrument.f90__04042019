MODULE PACE_INSTRUMENT_DESIGN
INTEGER,PARAMETER :: NWV_BAND=128,NWV_BAND_SEG2=6,NWV_BAND_SEG3=12

REAL*8,PARAMETER :: WV_START=350D0,WV_END=1000.D0,WV_BAND_WIDTH=5D0

REAL*8,DIMENSION(NWV_BAND):: WV_BAND

INTEGER,PARAMETER :: NILS_PACE=200
REAL*8,DIMENSION(NWV_BAND,NILS_PACE) :: ILS_DeltaWaveLength,ILS_PACE

CONTAINS

SUBROUTINE WV_PACE_SETUP
IMPLICIT NONE
INTEGER :: IWV

IF(NWV_BAND_SEG2 /= 6)STOP 'CHECK NWV AND NWV_SEG2'

DO IWV=1,NWV_BAND-NWV_BAND_SEG2-NWV_BAND_SEG3
  WV_BAND(IWV)=WV_START+(IWV-1.0D0)*WV_BAND_WIDTH
ENDDO

WV_BAND(NWV_BAND-NWV_BAND_SEG2-NWV_BAND_SEG3+1)=940d0
WV_BAND(NWV_BAND-NWV_BAND_SEG2-NWV_BAND_SEG3+2)=1240d0
WV_BAND(NWV_BAND-NWV_BAND_SEG2-NWV_BAND_SEG3+3)=1380d0
WV_BAND(NWV_BAND-NWV_BAND_SEG2-NWV_BAND_SEG3+4)=1640d0
WV_BAND(NWV_BAND-NWV_BAND_SEG2-NWV_BAND_SEG3+5)=2130d0
WV_BAND(NWV_BAND-NWV_BAND_SEG2-NWV_BAND_SEG3+6)=2250d0

WV_BAND(NWV_BAND-NWV_BAND_SEG3+1:NWV_BAND)=&
  (/340d0, 354d0, 388d0, 416d0, 442d0,451.5d0, 470d0,  &
    510d0, 551d0, 670d0, 765d0, 865d0/)

END SUBROUTINE WV_PACE_SETUP

SUBROUTINE ILS_INIT
IMPLICIT NONE
INTEGER IWV,ILS_LINE
REAL*8 Delta_Wavelength_Max,Delta_Wavelength_Sub,Factor
REAL*8 PACE_FWHM
PACE_FWHM=5.0d0
!PACE_FWHM=0.1d0
Delta_Wavelength_Max=4.0d0*PACE_FWHM
Delta_Wavelength_Sub=Delta_Wavelength_Max/(1.0d0*NILS_PACE)

Factor=4.0D0*log(2.0D0)/(PACE_FWHM**2)

ILS_DeltaWaveLength=0.0d0
DO IWV=1,NWV_BAND
DO ILS_LINE=1,NILS_PACE
   ILS_DeltaWaveLength(IWV,ILS_LINE)=(ILS_LINE-NILS_PACE/2)*Delta_Wavelength_Sub
   ILS_PACE(IWV,ILS_LINE)=exp(-Factor*(ILS_DeltaWaveLength(IWV,ILS_LINE)**2));
ENDDO
ENDDO

END SUBROUTINE ILS_INIT


END MODULE PACE_INSTRUMENT_DESIGN
